<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Spotify Game Player</title>
  <link rel="stylesheet" href="style.css"/>

  <script>
    // Fallback: if app.js fails to load on GitHub Pages, you'll see this alert.
    // app.js will overwrite window.__startGame when it loads.
    window.__startGame = function(){
      alert("app.js wurde nicht geladen (Pfad/Cache). Prüfe, ob app.js im selben Ordner wie index.html liegt und GitHub Pages neu deployed ist.");
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js"></script>
  <script defer src="./qr.js"></script>
  <script defer src="./app.js"></script>

</head>
<body>

<!-- STARTSCREEN -->
<div id="startScreen" class="startScreen">
  <div class="startInner">
    <div class="stars"></div>

    <div class="logoStack">
      <div class="neonTitle">HITSTER</div>
      <div class="neonSub">DAS MUSIK-PARTYSPIEL</div>
    </div>

    <div class="hero">
      <div class="speakerGlow">
        <div class="speaker"></div>
      </div>
    </div>

    <button id="btnStart" class="btnNeonPrimary" onclick="window.__startGame()">JETZT SPIELEN</button>
    <button id="btnToSettings" class="btnNeonGhost" onclick="window.__startGame()">SPIELREGELN &amp; EINSTELLUNGEN</button>

    <div class="startFoot">
      <span class="pill">Spotify Web Player</span>
      <span class="pill">QR Scan</span>
      <span class="pill">Party</span>
    </div>
  </div>
</div>

<div id="appShell" class="appShell isHidden">
  <header class="topbar">
    <div class="brand">Spotify Game Player</div>
    <div class="auth">
      <button id="btnLogin">Login</button>
      <button id="btnLogout" class="secondary">Logout</button>
    </div>
  </header>

  <main class="wrap">
    <section class="card">
      <h2>QR-Code</h2>
      <p class="hint">Nach dem Login startet der Scanner automatisch. Nach der Auflösung ➜ für die nächste Karte.</p>

      <!-- Buttons bleiben als Fallback im DOM, werden aber ausgeblendet -->
      <div class="scanRow isHidden">
        <button id="btnScan">QR scannen</button>
        <button id="btnStopScan" class="secondary" disabled>Stop</button>
      </div>

      <div id="camBox" class="camBox hidden">
        <div class="camHeader">
          <span>Kamera</span>
          <span class="camHint">Halte den QR-Code in den Rahmen</span>
        </div>
        <div class="camFrame">
          <video id="camVideo" autoplay playsinline muted></video>
          <div class="reticle"></div>
        </div>
      </div>
    </section>

    <section class="card">
      <h2>Player</h2>

      <!-- Großer Play (sichtbar wenn Track geladen & pausiert) -->
      <button id="btnBigPlay" class="bigPlay" aria-label="Play">
        <span class="bigPlayIcon">▶</span>
      </button>

      <!-- Kleiner Pfeil (sichtbar wenn spielt / „aufgelöst“) -->
      <button id="btnNext" class="nextArrow" aria-label="Nächste Karte scannen" title="Nächste Karte scannen">
        ➜
      </button>

      <p id="status" class="status">Nicht eingeloggt</p>
    </section>

    <!-- Song-Infos erst weiter unten sichtbar -->
    <div class="infoSpacer"></div>

    <section class="card infoCard">
      <h3>Song-Infos</h3>
      <div class="nowplaying">
        <img id="cover" class="cover" alt=""/>
        <div class="meta">
          <div id="trackName" class="track">—</div>
          <div id="artistName" class="artist">—</div>
          <a id="spotifyLink" class="link" target="_blank" rel="noopener">Auf Spotify öffnen</a>
        </div>
      </div>
    </section>
  </main>
</div>
</body>
</html>
